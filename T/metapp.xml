<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<doc>
<rowtype xpath="//metapp" max="1">
 <variable xpath="_key" substitution="%key" />
 <variable xpath="doctitle" substitution="%doctitle" />
 <variable xpath="doctitle" substitution="%jsdoctitle" escape="js" />
 <variable xpath="js" substitution="%js" />
	<variable xpath="css" substitution="%css" />
	<variable xpath="html" substitution="%html" />
	<variable xpath="head" substitution="%head" />
	<html><dialog id="#UNIQUEID#" class="dialog appeditor" draggable="true" ondragstart="app.dialog_drag_start(event)" ondrop="app.dialog_drop(event)" ondragover="app.dialog_drag_over(event);"><input type="hidden" value="%key" />
	 <input type="text" value="%doctitle" placeholder="doctitle" /><br/>
	 <textarea class="metapp-head" placeholder="head...">%head</textarea>
	 <textarea class="metapp-javascript" placeholder="javascript...">%js</textarea>
		<textarea class="metapp-style" placeholder="css...">%css</textarea>
		<textarea class="metapp-html" placeholder="html...">%html</textarea><br/>
		<button onclick="app.savemetapp('#UNIQUEID#');this.parentElement.close();"><i class="fa fa-floppy-o">
		</i></button><button onclick="if(confirm('Eliminare davvero il documento \'%jsdoctitle\' ?')){f$.db.del('%key');this.parentElement.close()}"><i class="fa fa-trash-o"> </i>
		</button><button title="preview!" onclick="app.metappPreview('#UNIQUEID#');"><i class="fa fa-play">
		</i></button><button onclick="this.parentElement.close()"><i class="fa fa-times"> </i></button>
		</dialog></html>
</rowtype>
		<onloadall>
			app.savemetapp=function(id){var x=document.getElementById(id);var dd=x.getElementsByTagName('textarea');var kk=x.getElementsByTagName('input');
				f$.db.getone(kk[0].value,function(o){o.doctitle=kk[1].value;o.head=dd[0].value;o.js=dd[1].value;o.css=dd[2].value;o.html=dd[3].value;f$.db.set(o);});};
				
			app.metappPreview=function(id){
				var x=document.getElementById(id);
				var dd=x.getElementsByTagName('textarea');
				var kk=x.getElementsByTagName('input');
				var o={$key:kk[0].value,doctitle:kk[1].value};
				o.head=dd[0].value;o.js=dd[1].value;o.css=dd[2].value;o.html=dd[3].value;
				tau.syncrender(tau.$$('hiddentarget'),tau.preloaded('T/metapp-run.xml'),tau.JSON2xmldoc(o,'metapp'),'append')};
				tau.$$('#UNIQUEID#').show();
		</onloadall>
</doc>